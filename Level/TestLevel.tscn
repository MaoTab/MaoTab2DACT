[gd_scene load_steps=30 format=3 uid="uid://cx0scs5ncd18h"]

[ext_resource type="Script" uid="uid://c1rs2dxntkota" path="res://Scripts/Level.cs" id="1_1yrnh"]
[ext_resource type="Texture2D" uid="uid://cm5iy4m56nuc7" path="res://Texture/NONE.webp" id="2_u18fy"]

[sub_resource type="Animation" id="Animation_1yrnh"]
resource_name = "new_animation"
step = 0.0333333

[sub_resource type="AnimationLibrary" id="AnimationLibrary_u18fy"]
_data = {
&"new_animation": SubResource("Animation_1yrnh")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_woh3p"]
size = Vector2(1, 1)

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_wkp8b"]
polygon = PackedVector2Array(-0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5)

[sub_resource type="GDScript" id="GDScript_uu6xs"]
resource_name = "Box"
script/source = "extends Area2D

func _on_body_entered(body: Node2D) -> void:
	# 检测发生碰撞的是否是玩家
	if body is not Player:
		# 如果不是就跳过 
		pass

	# 获取场景的音频控制器
	var node = get_node(\"/root/Root/Node\");
	var audio = node as AudioMixPlayer;
	# 判断播放器是否在播放中
	if audio.IsPlaying:
		# 如果在播放就切到1号，3秒完成
		audio.SwitchPlayerTo(0,3);
	else:
		# 如果没有播放就播放！
		audio.Play();
	
	pass
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_trn2v"]
size = Vector2(203, 20)

[sub_resource type="GDScript" id="GDScript_3dxm6"]
resource_name = "Box"
script/source = "extends Area2D

func _on_body_entered(body: Node2D) -> void:
	if body is not Player: 
		pass
		
	var node = get_node(\"/root/Root/Node\");
	var audio = node as AudioMixPlayer;
	if audio:
		if audio.IsPlaying:
			audio.SwitchPlayerTo(1,3);
		else:
			audio.Play();
	
	pass
"

[sub_resource type="GDScript" id="GDScript_lgr22"]
resource_name = "Box"
script/source = "extends Area2D

func _on_body_entered(body: Node2D) -> void:
	if body is not Player: 
		pass
		
	var node = get_node(\"/root/Root/Node\");
	var audio = node as AudioMixPlayer;
	if audio:
		if audio.IsPlaying:
			audio.SwitchPlayerTo(2,3);
		else:
			audio.Play();
	
	pass
"

[sub_resource type="Curve" id="Curve_lgr22"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.0874317, 1), 0.0, 0.0, 0, 0, Vector2(0.677596, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 4

[sub_resource type="CurveTexture" id="CurveTexture_trn2v"]
curve = SubResource("Curve_lgr22")

[sub_resource type="Curve" id="Curve_03owx"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.699454, 0.4381), -2.16281, -2.16281, 0, 0, Vector2(0.99999, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_wkp8b"]
curve = SubResource("Curve_03owx")

[sub_resource type="Curve" id="Curve_trn2v"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.348485, 0.59228), 1.63872, 1.63872, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_03owx"]
curve = SubResource("Curve_trn2v")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_03owx"]
particle_flag_disable_z = true
emission_shape = 1
emission_sphere_radius = 266.0
spread = 7.273
initial_velocity_min = 826.73
initial_velocity_max = 3000.0
gravity = Vector3(0, 100, 0)
scale_min = 1.5
scale_max = 1.5
scale_curve = SubResource("CurveTexture_wkp8b")
alpha_curve = SubResource("CurveTexture_trn2v")
turbulence_enabled = true
turbulence_noise_speed = Vector3(0, 9.825, 0)
turbulence_influence_min = 0.04
turbulence_influence_max = 0.04
turbulence_initial_displacement_min = -31.5
turbulence_initial_displacement_max = 12.2
turbulence_influence_over_life = SubResource("CurveTexture_03owx")
collision_mode = 1
collision_friction = 0.0
collision_bounce = 0.0

[sub_resource type="GDScript" id="GDScript_1yrnh"]
resource_name = "Box"
script/source = "extends Area2D


var wind = Vector2(2400,0)

func _on_body_entered(body: Node2D) -> void:
	if body is RigidBody2D:
		var r = body as RigidBody2D;
		r.add_constant_force(wind * 0.01);
		pass
	if body is not Player: 
		return
		
	var p = body as Player;
	p.AddExternalForce(wind);
	pass


func _on_body_exited(body: Node2D) -> void:
	if body is RigidBody2D:
		var r = body as RigidBody2D;
		r.add_constant_force(-wind * 0.01);
		pass
	if body is not Player: 
		return
		
	var p = body as Player;
	p.AddExternalForce(-wind);
	pass
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_u18fy"]
size = Vector2(1135.5, 286)

[sub_resource type="GDScript" id="GDScript_7x0wu"]
resource_name = "Box"
script/source = "extends Area2D

var wind = Vector2(0,-2000)

func _on_body_entered(body: Node2D) -> void:
	if body is not Player:
		return
		
	var p = body as Player;
	p.DoInteractionAction(InteractionAction.Create(0, \"Node_A\"));
	pass
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_xhnlc"]
size = Vector2(180, 286)

[sub_resource type="GDScript" id="GDScript_u18fy"]
resource_name = "Box"
script/source = "extends Area2D


var wind = Vector2(0,-2000)

func _on_body_entered(body: Node2D) -> void:
	if body is RigidBody2D:
		var r = body as RigidBody2D;
		r.add_constant_force(wind);
		pass
	
	if body is not Player: 
		return
		
	var p = body as Player;
	p.AddExternalForce(wind);
	pass


func _on_body_exited(body: Node2D) -> void:
	if body is RigidBody2D:
		var r = body as RigidBody2D;
		r.add_constant_force(-wind);
		pass
	
	if body is not Player: 
		return
		
	var p = body as Player;
	p.AddExternalForce(-wind);
	pass
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_1yrnh"]
size = Vector2(497.5, 286)

[sub_resource type="Curve" id="Curve_1yrnh"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0]
point_count = 1

[sub_resource type="Curve" id="Curve_u18fy"]
_data = [Vector2(0, 0.0704377), 0.0, 0.0, 0, 0, Vector2(0.404372, 0.202241), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_7x0wu"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0]
point_count = 1

[sub_resource type="CurveXYZTexture" id="CurveXYZTexture_xhnlc"]
curve_x = SubResource("Curve_1yrnh")
curve_y = SubResource("Curve_u18fy")
curve_z = SubResource("Curve_7x0wu")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_hh7ik"]
lifetime_randomness = 1.0
particle_flag_disable_z = true
emission_shape = 3
emission_box_extents = Vector3(72.35, 1, 1)
direction = Vector3(0, -1, 0)
spread = 0.0
initial_velocity_min = 1686.02
initial_velocity_max = 2000.0
gravity = Vector3(300, 100, 0)
scale_min = 0.0
scale_max = 7.43
scale_curve = SubResource("CurveXYZTexture_xhnlc")
alpha_curve = SubResource("CurveTexture_trn2v")
turbulence_enabled = true
turbulence_noise_speed = Vector3(0, 9.825, 0)
turbulence_influence_min = 0.072
turbulence_influence_max = 0.078
turbulence_initial_displacement_min = -31.5
turbulence_initial_displacement_max = 12.2
turbulence_influence_over_life = SubResource("CurveTexture_03owx")
collision_mode = 1
collision_friction = 0.0
collision_bounce = 0.0

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7x0wu"]
size = Vector2(30, 30)

[node name="TestLevel" type="Node2D" node_paths=PackedStringArray("SpawnPoint")]
script = ExtResource("1_1yrnh")
SpawnPoint = NodePath("SpawnPoint")

[node name="SpawnPoint" type="Node2D" parent="."]
position = Vector2(777, 423)

[node name="Plan3" type="Sprite2D" parent="."]
modulate = Color(0.43, 0.43, 0.43, 1)
position = Vector2(606.5, 148)
scale = Vector2(1179, 328)
texture = ExtResource("2_u18fy")

[node name="Plan7" type="Sprite2D" parent="."]
modulate = Color(0.493545, 0.493546, 0.493546, 1)
position = Vector2(606.5, 476)
scale = Vector2(1179, 328)
texture = ExtResource("2_u18fy")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Plan7"]
libraries = {
&"": SubResource("AnimationLibrary_u18fy")
}

[node name="Node2D2" type="Node2D" parent="."]

[node name="RichTextLabel" type="RichTextLabel" parent="Node2D2"]
offset_left = 171.0
offset_top = 98.0
offset_right = 339.0
offset_bottom = 164.0
theme_override_font_sizes/normal_font_size = 56
text = "强风区"
fit_content = true
autowrap_mode = 0

[node name="Plan" type="Node2D" parent="."]
position = Vector2(515, 236)

[node name="RichTextLabel" type="RichTextLabel" parent="Plan"]
offset_left = -42.0
offset_top = -65.0
offset_right = 48.0
offset_bottom = -42.0
theme_override_font_sizes/normal_font_size = 16
text = "在这切音频1"
fit_content = true
autowrap_mode = 0

[node name="StaticBody2D" type="AnimatableBody2D" parent="Plan"]
scale = Vector2(206.01, 16.556)
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan/StaticBody2D"]
shape = SubResource("RectangleShape2D_woh3p")
debug_color = Color(0, 0.815545, 0.194183, 1)

[node name="Plan" type="Sprite2D" parent="Plan/StaticBody2D"]
modulate = Color(0.796243, 0.796243, 0.796243, 1)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Plan/StaticBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="Area2D" type="Area2D" parent="Plan"]
position = Vector2(1, -23)
script = SubResource("GDScript_uu6xs")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan/Area2D"]
position = Vector2(0.5, 0)
shape = SubResource("RectangleShape2D_trn2v")

[node name="Plan2" type="Node2D" parent="."]
position = Vector2(778, 236)

[node name="RichTextLabel" type="RichTextLabel" parent="Plan2"]
offset_left = -52.0
offset_top = -64.0
offset_right = 54.0
offset_bottom = -41.0
theme_override_font_sizes/normal_font_size = 16
text = "跳到这切音频2"
fit_content = true
autowrap_mode = 0

[node name="StaticBody2D" type="AnimatableBody2D" parent="Plan2"]
scale = Vector2(206.01, 16.556)
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan2/StaticBody2D"]
shape = SubResource("RectangleShape2D_woh3p")
debug_color = Color(0, 0.815545, 0.194183, 1)

[node name="Plan" type="Sprite2D" parent="Plan2/StaticBody2D"]
modulate = Color(0.796243, 0.796243, 0.796243, 1)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Plan2/StaticBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="Area2D" type="Area2D" parent="Plan2"]
position = Vector2(1, -23)
script = SubResource("GDScript_3dxm6")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan2/Area2D"]
position = Vector2(0.5, 0)
shape = SubResource("RectangleShape2D_trn2v")

[node name="Plan5" type="Node2D" parent="."]
position = Vector2(509, 515)

[node name="StaticBody2D" type="AnimatableBody2D" parent="Plan5"]
scale = Vector2(206.01, 16.556)
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan5/StaticBody2D"]
shape = SubResource("RectangleShape2D_woh3p")
debug_color = Color(0, 0.815545, 0.194183, 1)

[node name="Plan" type="Sprite2D" parent="Plan5/StaticBody2D"]
modulate = Color(0.796243, 0.796243, 0.796243, 1)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Plan5/StaticBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="Plan6" type="Node2D" parent="."]
position = Vector2(772, 515)

[node name="StaticBody2D" type="AnimatableBody2D" parent="Plan6"]
scale = Vector2(206.01, 16.556)
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan6/StaticBody2D"]
shape = SubResource("RectangleShape2D_woh3p")
debug_color = Color(0, 0.815545, 0.194183, 1)

[node name="Plan" type="Sprite2D" parent="Plan6/StaticBody2D"]
modulate = Color(0.796243, 0.796243, 0.796243, 1)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Plan6/StaticBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="Plan9" type="Node2D" parent="."]
position = Vector2(1028, 651)

[node name="StaticBody2D" type="AnimatableBody2D" parent="Plan9"]
scale = Vector2(206.01, 16.556)
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan9/StaticBody2D"]
shape = SubResource("RectangleShape2D_woh3p")
debug_color = Color(0, 0.815545, 0.194183, 1)

[node name="Plan" type="Sprite2D" parent="Plan9/StaticBody2D"]
modulate = Color(0.796243, 0.796243, 0.796243, 1)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Plan9/StaticBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="Plan4" type="Node2D" parent="."]
position = Vector2(829, 128)

[node name="RichTextLabel" type="RichTextLabel" parent="Plan4"]
offset_left = -120.0
offset_top = -64.0
offset_right = 129.0
offset_bottom = -41.0
theme_override_font_sizes/normal_font_size = 16
text = "试试长按跳跃，或者..别的方法？"
fit_content = true
autowrap_mode = 0

[node name="StaticBody2D" type="AnimatableBody2D" parent="Plan4"]
scale = Vector2(206.01, 16.556)
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan4/StaticBody2D"]
shape = SubResource("RectangleShape2D_woh3p")
debug_color = Color(0, 0.815545, 0.194183, 1)

[node name="Plan" type="Sprite2D" parent="Plan4/StaticBody2D"]
modulate = Color(0.796243, 0.796243, 0.796243, 1)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Plan4/StaticBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="Area2D" type="Area2D" parent="Plan4"]
position = Vector2(1, -23)
script = SubResource("GDScript_lgr22")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan4/Area2D"]
position = Vector2(0.5, 0)
shape = SubResource("RectangleShape2D_trn2v")

[node name="Plan8" type="Node2D" parent="."]
position = Vector2(731, -196)

[node name="RichTextLabel" type="RichTextLabel" parent="Plan8"]
offset_left = -48.0
offset_top = -67.0
offset_right = 52.0
offset_bottom = -44.0
theme_override_font_sizes/normal_font_size = 16
text = "借助风的力量"
fit_content = true
autowrap_mode = 0

[node name="StaticBody2D" type="AnimatableBody2D" parent="Plan8"]
scale = Vector2(206.01, 16.556)
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan8/StaticBody2D"]
shape = SubResource("RectangleShape2D_woh3p")
debug_color = Color(0, 0.815545, 0.194183, 1)

[node name="Plan" type="Sprite2D" parent="Plan8/StaticBody2D"]
modulate = Color(0.796243, 0.796243, 0.796243, 1)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Plan8/StaticBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="Area2D" type="Area2D" parent="Plan8"]
position = Vector2(1, -23)
script = SubResource("GDScript_lgr22")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Plan8/Area2D"]
position = Vector2(0.5, 0)
shape = SubResource("RectangleShape2D_trn2v")

[node name="GPUParticles2D" type="GPUParticles2D" parent="."]
visible = false
position = Vector2(97, -252)
amount = 180
lifetime = 5.73
visibility_rect = Rect2(-100, -100, 2000, 2000)
draw_order = 0
process_material = SubResource("ParticleProcessMaterial_03owx")

[node name="GPUParticles2D2" type="GPUParticles2D" parent="."]
position = Vector2(-71, 63)
amount = 360
lifetime = 5.73
visibility_rect = Rect2(-100, -100, 2000, 2000)
draw_order = 0
process_material = SubResource("ParticleProcessMaterial_03owx")

[node name="WindZone" type="Area2D" parent="."]
position = Vector2(102, 84)
script = SubResource("GDScript_1yrnh")

[node name="CollisionShape2D" type="CollisionShape2D" parent="WindZone"]
position = Vector2(506.25, 66)
shape = SubResource("RectangleShape2D_u18fy")

[node name="ITestZone" type="Area2D" parent="."]
position = Vector2(509, 656)
rotation = 1.5708
script = SubResource("GDScript_7x0wu")

[node name="CollisionShape2D" type="CollisionShape2D" parent="ITestZone"]
position = Vector2(-240, 3.05176e-05)
shape = SubResource("RectangleShape2D_xhnlc")

[node name="Wind" type="Node2D" parent="."]
position = Vector2(1026, 466)

[node name="WindZone2" type="Area2D" parent="Wind"]
rotation = 1.5708
script = SubResource("GDScript_u18fy")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Wind/WindZone2"]
position = Vector2(-81.25, 0)
shape = SubResource("RectangleShape2D_1yrnh")

[node name="GPUParticles2D3" type="GPUParticles2D" parent="Wind"]
position = Vector2(0, 165)
amount = 266
amount_ratio = 0.2019
lifetime = 1.91
visibility_rect = Rect2(-1000, -1500, 2000, 2000)
draw_order = 0
trail_enabled = true
trail_lifetime = 0.02
process_material = SubResource("ParticleProcessMaterial_hh7ik")

[node name="RigidBody2D" type="RigidBody2D" parent="."]
position = Vector2(811, 479)

[node name="CollisionShape2D" type="CollisionShape2D" parent="RigidBody2D"]
shape = SubResource("RectangleShape2D_7x0wu")

[node name="Plan" type="Sprite2D" parent="RigidBody2D"]
modulate = Color(0.608302, 0.824233, 1, 1)
scale = Vector2(30, 30)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="RigidBody2D/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="RigidBody2D2" type="RigidBody2D" parent="."]
position = Vector2(747, 476)

[node name="CollisionShape2D" type="CollisionShape2D" parent="RigidBody2D2"]
shape = SubResource("RectangleShape2D_7x0wu")

[node name="Plan" type="Sprite2D" parent="RigidBody2D2"]
modulate = Color(0.608302, 0.824233, 1, 1)
scale = Vector2(30, 30)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="RigidBody2D2/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[node name="RigidBody2D3" type="RigidBody2D" parent="."]
position = Vector2(611, 484)

[node name="CollisionShape2D" type="CollisionShape2D" parent="RigidBody2D3"]
shape = SubResource("RectangleShape2D_7x0wu")

[node name="Plan" type="Sprite2D" parent="RigidBody2D3"]
modulate = Color(0.608302, 0.824233, 1, 1)
scale = Vector2(30, 30)
texture = ExtResource("2_u18fy")

[node name="LightOccluder2D" type="LightOccluder2D" parent="RigidBody2D3/Plan"]
occluder = SubResource("OccluderPolygon2D_wkp8b")

[connection signal="body_entered" from="Plan/Area2D" to="Plan/Area2D" method="_on_body_entered"]
[connection signal="body_entered" from="Plan2/Area2D" to="Plan2/Area2D" method="_on_body_entered"]
[connection signal="body_entered" from="Plan4/Area2D" to="Plan4/Area2D" method="_on_body_entered"]
[connection signal="body_entered" from="Plan8/Area2D" to="Plan8/Area2D" method="_on_body_entered"]
[connection signal="body_entered" from="WindZone" to="WindZone" method="_on_body_entered"]
[connection signal="body_exited" from="WindZone" to="WindZone" method="_on_body_exited"]
[connection signal="body_entered" from="ITestZone" to="ITestZone" method="_on_body_entered"]
[connection signal="body_exited" from="ITestZone" to="ITestZone" method="_on_body_exited"]
[connection signal="body_entered" from="Wind/WindZone2" to="Wind/WindZone2" method="_on_body_entered"]
[connection signal="body_exited" from="Wind/WindZone2" to="Wind/WindZone2" method="_on_body_exited"]
